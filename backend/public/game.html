<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–†—ã–±–∞–ª–∫–∞ - MVP</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  
  <section id="shop" class="hidden">
    <div class="shop__container">
      <div class="shopnav">
        <h1>–ú–∞–≥–∞–∑–∏–Ω</h1>
        <button id="closeShop">‚úñ</button>
      </div>
      <div class="shop__info">
        <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∞–≥–∞–∑–∏–Ω! –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –∫—É–ø–∏—Ç—å —É–ª—É—á—à–µ–Ω–∏—è –¥–ª—è —Å–≤–æ–µ–π —Ä—ã–±–∞–ª–∫–∏.</p>
      </div>
      <div class="shop__grid">
        <div class="shop-item">
          
        </div>
        <div class="shop-item">
          <h3>–£–¥–æ—á–∫–∞ (+10% —à–∞–Ω—Å –∫–ª—ë–≤–∞)</h3>
          <img src="./images/rod.png" alt="">
          <button data-item="rod" data-price="100">–ö—É–ø–∏—Ç—å –∑–∞ 100</button>
        </div>
        <div class="shop-item">
          <h3>–ù–∞–∂–∏–≤–∫–∞ (+15% —à–∞–Ω—Å –∫–ª—ë–≤–∞)</h3>
          <img src="./images/worm.png" alt="">
          <button data-item="bait" data-price="150">–ö—É–ø–∏—Ç—å –∑–∞ 150</button>
        </div>
      </div>
      <div class="shop-item-fw">
          <h3>–ü—Ä–æ–¥–∞—Ç—å —É–ª–æ–≤ –Ω–∞</h3>
          <button class="sell" onclick="sell()"><span id="sellCount"></span> –ú–æ–Ω–µ—Ç</button>
        </div>
    </div>
  </section>

<div class="inventory-modal hidden" id="inventory-modal">
  <div class="inventoryNav">
    <h1>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h1>
    <button class="mb-0" id="closeInventoryButton">‚úñ</button>
  </div>
  <div class="inventory-grid">
    <div class="inventory-slot">
      <div class="slot-label">–£–¥–æ—á–∫–∞</div>
      <img src="images/rod.png" alt="–£–¥–æ—á–∫–∞" class="slot-image" />
    </div>
    <div class="inventory-slot">
      <div class="slot-label">–ù–∞–∂–∏–≤–∫–∞</div>
      <img src="images/bait.png" alt="–ù–∞–∂–∏–≤–∫–∞" class="slot-image" />
    </div>
    <div class="inventory-slot">
      <div class="slot-label">–õ–µ—Å–∫–∞</div>
      <img src="images/line.png" alt="–õ–µ—Å–∫–∞" class="slot-image" />
    </div>
    <div class="inventory-slot">
      <div class="slot-label">–ö—Ä—é—á–æ–∫</div>
      <img src="images/hook.png" alt="–ö—Ä—é—á–æ–∫" class="slot-image" />
    </div>
    <div class="inventory-slot">
      <div class="slot-label">–ö–∞—Ç—É—à–∫–∞</div>
      <img src="images/reel.png" alt="–ö–∞—Ç—É—à–∫–∞" class="slot-image" />
    </div>
  </div>
</div>

  <aside class="profile hidden" id="profile">
    <div class="account_title">
      <h1 class="profile-title">–ü—Ä–æ—Ñ–∏–ª—å</h1>
    <button id="closeProfileButton" class="close-button">‚úñ</button>
    </div>
    <div class="account">
      <img class="avatar" src="./images/fishing-rod.png" alt="">
      <h2 class="username">–ò–≥—Ä–æ–∫</h2>
      <p class="account-info">ID: <span id="userIdDisplay">000</span></p>
      <div class="balance">
        <h2 class="coins-display mb-10">–ú–æ–Ω–µ—Ç—ã: <span id="coinsProfile">0</span></h2>
        <h2><div id="balanceDisplay" class="balance-box mb-10">–ë–∞–ª–∞–Ω—Å: ‚Äî</div></h2>
      </div>
      <!-- <p class="account-info">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É "–ù–∞ –ö—Ä—é—á–∫–µ"! –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞—Å–ª–∞–¥–∏—Ç—å—Å—è —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–π —Ä—ã–±–∞–ª–∫–æ–π, –ª–æ–≤—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∏–¥—ã —Ä—ã–± –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—è –º–æ–Ω–µ—Ç—ã.</p>
      <p class="account-info">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É "–ó–∞–±—Ä–æ—Å–∏—Ç—å —É–¥–æ—á–∫—É", —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ä—ã–±–∞–ª–∫—É. –ß–µ–º –±–æ–ª—å—à–µ –≤—ã –∏–≥—Ä–∞–µ—Ç–µ, —Ç–µ–º –±–æ–ª—å—à–µ –º–æ–Ω–µ—Ç –≤—ã –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç–µ!</p>
      <p class="account-info">–ù–µ –∑–∞–±—É–¥—å—Ç–µ –ø–æ—Å–µ—Ç–∏—Ç—å –º–∞–≥–∞–∑–∏–Ω, —á—Ç–æ–±—ã –∫—É–ø–∏—Ç—å —É–ª—É—á—à–µ–Ω–∏—è –¥–ª—è —Å–≤–æ–µ–π —Ä—ã–±–∞–ª–∫–∏.</p> -->
      <div class="account_nav">
        <button id="openShopButton">–û—Ç–∫—Ä—ã—Ç—å –º–∞–≥–∞–∑–∏–Ω</button>
        <button id="inventoryButton">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
        <button id="replenishBalanceButton">–ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å</button>
        <button id="supportButton">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</button>
        <button id="logoutButton">–í—ã–π—Ç–∏</button>
      </div>
    </div>
  </aside>

  <aside class="chat-container hidden" id="chatContainer">
    <div class="chat-header">
      <h2>–ß–∞—Ç</h2>
      <button class="mb-0" id="closeChatButton">‚úñ</button>
    </div>
    <div class="chat-messages" id="chatMessages">
      <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ -->
    </div>
    <form id="chatForm" class="chat-form">
      <input type="text" id="chatInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." required>
      <button class="mb-0" id="chatSubmitBtn" type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    </form>
  </aside>

    <img class="logo" src="./images/logo_without_bg.png" alt="">
  <div class="game-container">
    <div class="location-selector">
      <label for="locationSelect">–í—ã–±–µ—Ä–∏ –ª–æ–∫–∞—Ü–∏—é:</label>
      <select id="locationSelect">
        <option value="river">–†–µ–∫–∞</option>
        <option value="lake">–û–∑–µ—Ä–æ</option>
      </select>
      
    </div>
    <div class="location" style="position: relative;">
      <img id="locationImage" src="./images/river.jpg" alt="–õ–æ–∫–∞—Ü–∏—è" class="location-img">
      <div class="overlay" id="timeOverlay"></div>
      <div class="time-display" id="timeDisplay">00:00</div>
      <div id="floatBob"></div>
    </div>
    <div class="controls">
      <button id="castButton">–ó–∞–±—Ä–æ—Å–∏—Ç—å —É–¥–æ—á–∫—É</button>
      <button id="openShop">–ú–∞–≥–∞–∑–∏–Ω</button>
      <button id="profileBtn">–ü—Ä–æ—Ñ–∏–ª—å</button>
      <button id="chatButton">–ß–∞—Ç</button>
      <h2 class="coins-display">–ú–æ–Ω–µ—Ç—ã: <span id="coins">0</span></h2>
    </div>

    
    <div class="result" id="result"></div>
    <h2>–ü–æ–π–º–∞–Ω–Ω—ã–µ —Ä—ã–±—ã</h2>
    <ul id="catchList"></ul>
  </div>
  <script>
    async function loadUserBalance() {
    const userId = localStorage.getItem('userId');
    if (!userId) return;

    try {
        const res = await fetch(`/api/user/${userId}/balance`);
        const data = await res.json();

        if (res.ok) {
            document.getElementById('balanceDisplay').textContent = `–ë–∞–ª–∞–Ω—Å: ${data.balance} üé£`;
        } else {
            console.error(data.error || '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∞–ª–∞–Ω—Å–∞');
        }
    } catch (err) {
        console.error('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É:', err);
    }
}

window.onload = () => {
    loadUserBalance();
};
  </script>
  <script src="/socket.io/socket.io.js"></script>
  <script src="chat.js"></script>
  <script src="script.js" defer></script>
</body>
</html>
